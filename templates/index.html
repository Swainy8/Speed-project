<!DOCTYPE html>
<html lang="en">
<head>
    <meta charset="UTF-8" />
    <title>Recipe Realm</title>
    <style>
        :root {
            --bg: #f7f7f7;
            --card-bg: #ffffff;
            --text: #111827;
            --accent: #4CAF50;
            --accent-soft: #e5f7eb;
        }

        body {
            font-family: Arial, sans-serif;
            background: var(--bg);
            color: var(--text);
            display: flex;
            justify-content: center;
            align-items: center;
            min-height: 100vh;
            margin: 0;
        }

        /* THEMES */

        body.theme-light {
            --bg: #f7f7f7;
            --card-bg: #ffffff;
            --text: #111827;
            --accent: #4CAF50;
            --accent-soft: #e5f7eb;
        }

        body.theme-dark {
            --bg: #020617;
            --card-bg: #0f172a;
            --text: #e5e7eb;
            --accent: #38bdf8;
            --accent-soft: #0b1120;
        }

        body.theme-sunset {
            --bg: radial-gradient(circle at top, #f97316 0, #1e293b 55%);
            --card-bg: rgba(15, 23, 42, 0.9);
            --text: #f9fafb;
            --accent: #f97316;
            --accent-soft: rgba(248, 171, 94, 0.2);
        }

        body.theme-forest {
            --bg: radial-gradient(circle at top, #22c55e 0, #022c22 55%);
            --card-bg: rgba(6, 78, 59, 0.95);
            --text: #ecfdf5;
            --accent: #a3e635;
            --accent-soft: rgba(74, 222, 128, 0.18);
        }

        body.theme-ocean {
            --bg: radial-gradient(circle at top, #22d3ee 0, #0f172a 55%);
            --card-bg: rgba(15, 23, 42, 0.95);
            --text: #e0f2fe;
            --accent: #38bdf8;
            --accent-soft: rgba(56, 189, 248, 0.18);
        }

        .card {
            background: var(--card-bg);
            padding: 20px;
            border-radius: 16px;
            box-shadow: 0 4px 14px rgba(0,0,0,0.2);
            max-width: 400px;
            width: 90%;
            text-align: center;
            backdrop-filter: blur(8px);
        }

        img {
    width: 100%;
    border-radius: 12px;
    object-fit: cover;
}

        h2 {
            margin-top: 16px;
            margin-bottom: 8px;
        }

        p {
            margin-top: 0;
            margin-bottom: 16px;
            color: var(--text);
            opacity: 0.9;
        }

        .buttons {
            display: flex;
            justify-content: space-between;
            align-items: center;
            margin-top: 10px;
        }

        button {
            border: none;
            padding: 10px 16px;
            border-radius: 999px;
            cursor: pointer;
            font-size: 14px;
        }

        #prevBtn, #nextBtn {
            background: var(--accent-soft);
            color: var(--text);
        }

        #heartBtn {
            font-size: 24px;
            background: transparent;
            color: var(--text);
        }

        .liked {
            color: #ef4444;
        }

        .add-wrapper {
            margin-top: 16px;
        }

        .add-btn {
            display: inline-block;
            padding: 8px 14px;
            border-radius: 999px;
            background: var(--accent);
            color: white;
            text-decoration: none;
            font-size: 14px;
        }

        .add-btn:hover {
            opacity: 0.9;
        }

        /* SETTINGS BUTTON (top-right) */
        .settings-btn {
            position: fixed;
            top: 16px;
            right: 16px;
            padding: 8px 12px;
            border-radius: 999px;
            background: rgba(15, 23, 42, 0.85);
            color: #e5e7eb;
            text-decoration: none;
            font-size: 13px;
            display: inline-flex;
            align-items: center;
            gap: 6px;
            backdrop-filter: blur(6px);
            z-index: 2000;
        }

        .settings-btn span {
            font-size: 14px;
        }

        /* üî• FULL 3D LOADING SCREEN: RECIPE REALM */

        .loader-overlay {
            position: fixed;
            inset: 0;
            background: radial-gradient(circle at top, #f97316 0, #020617 60%);
            display: flex;
            flex-direction: column;
            justify-content: center;
            align-items: center;
            z-index: 9999;
            transition: opacity 0.9s ease, visibility 0.9s ease;
            perspective: 1400px;
            overflow: hidden;
        }

        .loader-overlay.hidden {
            opacity: 0;
            visibility: hidden;
        }

        /* 3D TITLE: RECIPE REALM */

        .logo-container {
            position: relative;
            transform-style: preserve-3d;
            animation: logoFloat 4s ease-in-out infinite alternate;
            margin-bottom: 48px;
        }

        .logo-3d {
            font-size: 64px;
            letter-spacing: 0.18em;
            text-transform: uppercase;
            display: flex;
            justify-content: center;
            transform-style: preserve-3d;
        }

        .logo-word {
            display: flex;
        }

        .logo-word + .logo-word {
            margin-left: 22px;
        }

.logo-letter {
    position: relative;
    display: inline-block;
    padding: 6px 6px;
    transform-style: preserve-3d;
    transform: translateZ(46px) rotateX(20deg);
    font-weight: 900;
    color: #fefce8; /* soft white */
    -webkit-text-stroke: 1px rgba(15, 23, 42, 0.9);
    text-shadow:
        0 3px 2px rgba(15, 23, 42, 0.95),
        0 16px 30px rgba(0, 0, 0, 0.9);
}

        .logo-letter::before {
            content: attr(data-letter);
            position: absolute;
            inset: 0;
            transform: translateZ(-22px) skewY(12deg);
            color: rgba(15, 23, 42, 0.9);
            filter: blur(1px);
        }

        .logo-glow {
            position: absolute;
            inset: -50px -90px;
            background: radial-gradient(circle at center, rgba(251, 191, 36, 0.4), transparent 60%);
            filter: blur(14px);
            transform: translateZ(-50px);
            opacity: 0.9;
        }

        @keyframes logoFloat {
            from {
                transform: rotateX(18deg) rotateY(-15deg) translateY(-12px);
            }
            to {
                transform: rotateX(26deg) rotateY(18deg) translateY(12px);
            }
        }

        /* 3D ROTATING + DRAGGABLE FOOD CUBE */

        .cube-scene {
            width: 190px;
            height: 190px;
            position: relative;
            transform-style: preserve-3d;
            margin-top: 4px;
            cursor: grab;
        }

        .cube-scene.dragging {
            cursor: grabbing;
        }

        .cube {
            width: 140px;
            height: 140px;
            position: absolute;
            top: 50%;
            left: 50%;
            transform-style: preserve-3d;
            /* transform set dynamically in JS */
        }

        .cube-face {
            position: absolute;
            width: 140px;
            height: 140px;
            border-radius: 26px;
            display: flex;
            align-items: center;
            justify-content: center;
            font-size: 52px;
            box-shadow:
                0 18px 40px rgba(0, 0, 0, 0.6),
                0 0 0 1px rgba(148, 163, 184, 0.4);
            background: radial-gradient(circle at 30% 20%, #0f172a, #0f766e);
            color: #e5e7eb;
        }

        .cube-face-front  { transform: translateZ(70px); }
        .cube-face-back   { transform: rotateY(180deg) translateZ(70px); }
        .cube-face-right  { transform: rotateY(90deg) translateZ(70px); }
        .cube-face-left   { transform: rotateY(-90deg) translateZ(70px); }
        .cube-face-top    { transform: rotateX(90deg) translateZ(70px); }
        .cube-face-bottom { transform: rotateX(-90deg) translateZ(70px); }

        .cube-shadow {
            position: absolute;
            width: 180px;
            height: 40px;
            background: radial-gradient(circle, rgba(0, 0, 0, 0.7), transparent 70%);
            bottom: -10px;
            left: 50%;
            transform: translateX(-50%);
            filter: blur(6px);
            opacity: 0.85;
        }

        /* LOADER FOOTER TEXT + DOTS */

        .loader-footer {
            margin-top: 32px;
            text-align: center;
            color: #fefce8;
            font-size: 14px;
            letter-spacing: 0.12em;
            text-transform: uppercase;
        }

        .loader-footer span.accent {
            color: #facc15;
        }

        .loader-dots {
            display: inline-block;
            margin-left: 6px;
        }

        .loader-dot {
            display: inline-block;
            width: 7px;
            height: 7px;
            border-radius: 999px;
            background: #fed7aa;
            margin: 0 2px;
            animation: dotPulse 1.4s infinite ease-in-out;
        }

        .loader-dot:nth-child(2) { animation-delay: 0.2s; }
        .loader-dot:nth-child(3) { animation-delay: 0.4s; }

        .recipe-image {
    width: 100%;
    max-width: 100%;
    height: 260px;      /* change this number for taller/shorter images */
    object-fit: cover;  /* fills the box and crops edges */
    display: block;
}

        @keyframes dotPulse {
            0%, 100% { transform: translateY(0) scale(0.85); opacity: 0.4; }
            50%      { transform: translateY(-4px) scale(1.2); opacity: 1; }
        }
    </style>
</head>
<body>
    <!-- üî• FULL 3D LOADING SCREEN: RECIPE REALM -->
    <div id="loader" class="loader-overlay">
        <div class="logo-container">
            <div class="logo-glow"></div>
            <div class="logo-3d">
                <div class="logo-word">
                    <span class="logo-letter" data-letter="R">R</span>
                    <span class="logo-letter" data-letter="E">E</span>
                    <span class="logo-letter" data-letter="C">C</span>
                    <span class="logo-letter" data-letter="I">I</span>
                    <span class="logo-letter" data-letter="P">P</span>
                    <span class="logo-letter" data-letter="E">E</span>
                </div>
                <div class="logo-word">
                    <span class="logo-letter" data-letter="R">R</span>
                    <span class="logo-letter" data-letter="E">E</span>
                    <span class="logo-letter" data-letter="A">A</span>
                    <span class="logo-letter" data-letter="L">L</span>
                    <span class="logo-letter" data-letter="M">M</span>
                </div>
            </div>
        </div>

        <div class="cube-scene" id="cubeScene">
            <div class="cube" id="cube">
                <div class="cube-face cube-face-front">üçï</div>
                <div class="cube-face cube-face-back">ü•ë</div>
                <div class="cube-face cube-face-right">üç£</div>
                <div class="cube-face cube-face-left">üçî</div>
                <div class="cube-face cube-face-top">üßÅ</div>
                <div class="cube-face cube-face-bottom">ü•ó</div>
            </div>
            <div class="cube-shadow"></div>
        </div>

        <div class="loader-footer">
            <span class="accent">Entering Recipe Realm</span>
            <span class="loader-dots">
                <span class="loader-dot"></span>
                <span class="loader-dot"></span>
                <span class="loader-dot"></span>
            </span>
        </div>
    </div>

    <a href="{{ url_for('settings') }}" class="settings-btn">
        <span>‚öô</span> Settings
    </a>

    <div class="card">
        <img id="recipeImage"
     class="recipe-image"
     src="{{ url_for('static', filename='images/' + recipes[0].image) }}"
     alt="Recipe Image" />


        <h2 id="recipeName">{{ recipes[0].name }}</h2>
        <p id="recipeDescription">{{ recipes[0].description }}</p>

        <div class="buttons">
            <button id="prevBtn">‚Üê Previous</button>
            <button id="heartBtn">‚ô°</button>
            <button id="nextBtn">Next ‚Üí</button>
        </div>

        <div class="add-wrapper">
            <a href="{{ url_for('add_recipe') }}" class="add-btn">+ Add Recipe</a>
        </div>
    </div>

    <script>
        // THEME + SETTINGS HELPERS
        const THEMES = ["light", "dark", "sunset", "forest", "ocean"];

        function applyTheme(theme) {
            if (!THEMES.includes(theme)) theme = "light";
            document.body.classList.remove(...THEMES.map(t => "theme-" + t));
            document.body.classList.add("theme-" + theme);
        }

        function loadSettings() {
            const theme = localStorage.getItem("theme") || "light";
            const showDescriptions = localStorage.getItem("showDescriptions");
            return {
                theme,
                showDescriptions: showDescriptions === null ? true : showDescriptions === "true"
            };
        }

        const settings = loadSettings();
        applyTheme(settings.theme);

        // CAROUSEL LOGIC
        const recipeData = JSON.parse('{{ recipes | tojson | safe }}');
        const imageBase = "{{ url_for('static', filename='images/') }}";

        let currentIndex = 0;
        const liked = new Set();

        const imgEl = document.getElementById("recipeImage");
        const nameEl = document.getElementById("recipeName");
        const descEl = document.getElementById("recipeDescription");
        const heartBtn = document.getElementById("heartBtn");
        const prevBtn = document.getElementById("prevBtn");
        const nextBtn = document.getElementById("nextBtn");

        function updateRecipe() {
            const recipe = recipeData[currentIndex];
            imgEl.src = imageBase + recipe.image;
            nameEl.textContent = recipe.name;
            descEl.textContent = recipe.description;

            if (settings.showDescriptions) {
                descEl.style.display = "block";
            } else {
                descEl.style.display = "none";
            }

            if (liked.has(currentIndex)) {
                heartBtn.textContent = "‚ô•";
                heartBtn.classList.add("liked");
            } else {
                heartBtn.textContent = "‚ô°";
                heartBtn.classList.remove("liked");
            }
        }

        prevBtn.addEventListener("click", () => {
            currentIndex = (currentIndex - 1 + recipeData.length) % recipeData.length;
            updateRecipe();
        });

        nextBtn.addEventListener("click", () => {
            currentIndex = (currentIndex + 1) % recipeData.length;
            updateRecipe();
        });

        heartBtn.addEventListener("click", () => {
            if (liked.has(currentIndex)) {
                liked.delete(currentIndex);
            } else {
                liked.add(currentIndex);
            }
            updateRecipe();
        });

        updateRecipe();

        // üîÑ 3D CUBE ROTATION (AUTO + DRAG)

        const cube = document.getElementById("cube");
        const cubeScene = document.getElementById("cubeScene");

        let rotX = -30;
        let rotY = 35;

        function applyCubeTransform() {
            cube.style.transform =
                `translate(-50%, -50%) rotateX(${rotX}deg) rotateY(${rotY}deg)`;
        }
        applyCubeTransform();

        let autoRotate = true;
        let lastTime = null;

        function animateCube(time) {
            if (autoRotate) {
                if (lastTime != null) {
                    const delta = time - lastTime; // ms
                    rotY += delta * 0.02;  // slow spin
                    applyCubeTransform();
                }
                lastTime = time;
            } else {
                lastTime = time;
            }
            requestAnimationFrame(animateCube);
        }
        requestAnimationFrame(animateCube);

        let isDragging = false;
        let startX = 0;
        let startY = 0;
        let startRotX = rotX;
        let startRotY = rotY;

        function startDrag(x, y) {
            isDragging = true;
            autoRotate = false;
            startX = x;
            startY = y;
            startRotX = rotX;
            startRotY = rotY;
            cubeScene.classList.add("dragging");
        }

        function moveDrag(x, y) {
            if (!isDragging) return;
            const dx = x - startX;
            const dy = y - startY;
            rotY = startRotY + dx * 0.3;     // horizontal drag = rotate Y
            rotX = startRotX - dy * 0.3;     // vertical drag = rotate X
            applyCubeTransform();
        }

        function endDrag() {
            if (!isDragging) return;
            isDragging = false;
            cubeScene.classList.remove("dragging");
            // Resume gentle auto-rotate after a pause
            setTimeout(() => {
                autoRotate = true;
                lastTime = null;
            }, 1500);
        }

        // Mouse events
        cubeScene.addEventListener("mousedown", (e) => {
            startDrag(e.clientX, e.clientY);
        });

        window.addEventListener("mousemove", (e) => {
            moveDrag(e.clientX, e.clientY);
        });

        window.addEventListener("mouseup", endDrag);

        // Touch events (for trackpads / touchscreens)
        cubeScene.addEventListener("touchstart", (e) => {
            const t = e.touches[0];
            startDrag(t.clientX, t.clientY);
        }, { passive: true });

        window.addEventListener("touchmove", (e) => {
            if (!isDragging) return;
            const t = e.touches[0];
            moveDrag(t.clientX, t.clientY);
        }, { passive: true });

        window.addEventListener("touchend", endDrag);

        // ‚è± Keep loading screen visible longer for full 3D effect
        window.addEventListener("load", () => {
            const loader = document.getElementById("loader");
            if (loader) {
                setTimeout(() => {
                    loader.classList.add("hidden");
                }, 6000); // 6 seconds
            }
        });
    </script>
</body>
</html>




